<% include header.html %>
<style>
    .tooltip1 {
      position: relative;
      display: inline-block;
    }
    
    .tooltip1 .tooltiptext1 {
      visibility: hidden;
      width: 120px;
      background-color: black;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px 0;
      font-size: 10px;
    
      /* Position the tooltip */
      position: absolute;
      margin: 22px -95px;
      z-index: 1;
    }
    
    .tooltip1:hover .tooltiptext1 {
      visibility: visible;
    }
    .td_align{
        text-align:center !important;
    }
    .modal-header {
        background-color: #f8f9fa;
        border-bottom: none;
        border-radius: 12px;
    }
    .modal-body {
        max-height: 70vh; 
        overflow-y: auto;
    }

    .modal-content{
        border-radius: 12px;
        border-width: 1px;
    }
    .modal-title {
        font-size: 21px;
        font-weight: 700;
        color: rgb(37, 14, 98);
        text-align: center;
        margin: 1rem 0;
    }
    .static-text {
        font-weight: bold;
        font-size: 16px;
        color: rgb(37, 14, 98);
    }

    .dynamic-text {
        color: #000000;
        font-size: 16px;
    }
    .card-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: rgb(37, 14, 98);
    }

    </style>
<!-- PAGE CONTENT WRAPPER -->
<div id="content">
    <div class="page-content-wrap">
        <% if(response_code != ''){ %>
            <div class="alert alert-success" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only"><%= __('button_close') %></span></button>
                <p align="center"> <strong><%=  __(String(response_code)) %></strong></p>
            </div>
        <% }else if(typeof message != 'undefined'){ %>
            <div class="alert alert-success" role="alert">
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only"><%= __('button_close') %></span></button>
                <p align="center"> <strong><%= __(message) %></strong></p>
            </div>
        <% } %>

        <div class="alert alert-success" role="alert" id="promo_error" style="display:none">
        <button type="button" id="close" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only"><%= __('button_close') %></span></button>
        <p align="center" id="message"> <strong></strong></p>
    </div>
        <!-- START TIMELINE FILTER -->

        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form class="form-horizontal" role="form" method="post" action="/<%= provider_page_type %>">
                        <input type="hidden" name="provider_page_type" value="<%= provider_page_type %>" />
                        <input type="hidden" name="page" id="page" value="1" />
                        <div class="form-group">

                            <div class="col-md-4">
                                <div style="text-align: center;">
                                    <label><%= __('title_sort') %></label>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group">
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-sort"></span></span>
                                        <select class="form-control select" data-none-selected-text="<%= __('title_nothing_selected') %>" placeholder="Select to Sort" name="sort_item">
                                            <option value='unique_id' id="unique_ids"><%= __('title_id') %></option>
                                            <option id="first_names" value='first_name'><%= __('title_name') %></option>
                                            <option value='created_at' id="created_ats"><%= __('title_registered_date') %></option>
                                            <option id="total_requests" value='total_request'><%= __('title_total_request') %></option>
                                            <option id="accepted_requests" value='accepted_request'><%= __('title_accepted_request') %></option>
                                            <option id="completed_requests" value='completed_request'><%= __('title_completed') %></option>
                                            <option id="cancelled_requests" value='cancelled_request'><%= __('title_cancelled_request') %></option>
                                            <option id="emails" value='email'><%= __('title_email') %></option>
                                            
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group">
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-sort"></span></span>
                                        <select class="form-control select" data-none-selected-text="<%= __('title_nothing_selected') %>" placeholder="Select to Sort" name="sort_item">
                                            <% if(sort_order == "1") { %>
                                            <option value="1" selected><%= __('sort_asc') %></option>
                                            <option value="-1"><%= __('sort_desc') %></option>
                                            <% } else{ %>
                                            <option value="1" ><%= __('sort_asc') %></option>
                                            <option value="-1" selected><%= __('sort_desc') %></option>
                                            <% } %>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div style="text-align: center;">
                                    <label><%= __('title_search') %></label>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group">
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-sort"></span></span>
                                        <select class="form-control select" data-none-selected-text="<%= __('title_nothing_selected') %>" id="sel" placeholder="Select to Sort" name="search_item">
                                            <% if(search_item == "first_name") { %>
                                            <option value='cedula'><%= __('title_cedula') %></option>
                                            <option value='first_name' selected><%= __('title_name') %></option>
                                            <option value='email'><%= __('title_email') %></option>
                                            <option value='city'><%= __('title_city') %></option>
                                            <option value='phone'><%= __('title_phone') %></option>
                                            <% } else if(search_item == "email") { %>
                                            <option value='cedula'><%= __('title_cedula') %></option>
                                            <option value='first_name'><%= __('title_name') %></option>
                                            <option value='email' selected><%= __('title_email') %></option>
                                            <option value='city'><%= __('title_city') %></option>
                                            <option value='phone'><%= __('title_phone') %></option>
                                            <% } else if(search_item == "unique_id") { %>
                                            <option value='cedula' selected><%= __('title_cedula') %></option>
                                            <option value='first_name'><%= __('title_name') %></option>
                                            <option value='email'><%= __('title_email') %></option>
                                            <option value='city'><%= __('title_city') %></option>
                                            <option value='phone'><%= __('title_phone') %></option>
                                            <% } else if(search_item == "phone") { %>
                                            <option value='cedula'><%= __('title_cedula') %></option>
                                            <option value='first_name'><%= __('title_name') %></option>
                                            <option value='email'><%= __('title_email') %></option>
                                            <option value='city'><%= __('title_city') %></option>
                                            <option value='phone' selected><%= __('title_phone') %></option>
                                            <% } else{ %>
                                            <option value='cedula'><%= __('title_cedula') %></option>
                                            <option value='first_name' ><%= __('title_name') %></option>
                                            <option value='email' ><%= __('title_email') %></option>
                                            <option value='city' selected><%= __('title_city') %></option>
                                            <option value='phone'><%= __('title_phone') %></option>
                                            <% } %>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="panel panel-default">
                                        <div class="panel-body panel-body-search">
                                            <div class="input-group">
                                                <span class="input-group-addon"><span class="fa fa-search"></span></span>
                                                <input type="text" class="form-control" value="<%= search_value %>" onkeypress="return alphaNumSpace(event);"name="search_value" placeholder="<%= __('title_search') %>"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div style="text-align: center;">
                                    <label><%= __('title_date_filter') %></label>
                                </div>
                                <div class="col-md-12">

                                    <div class="btn-group">
                                        <div class="input-group">
                                            <input type="text" class="form-control datepicker" value="<%= filter_start_date %>" placeholder="<%= __('title_start_date') %>" name="start_date"
                                                   id="start_date" readonly/>
                                            <span class="input-group-addon add-on">-</span>
                                            <input type="text" class="form-control datepicker" value="<%= filter_end_date %>" placeholder="<%= __('title_end_date') %>" name="end_date"
                                                   id="end_date" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="col-md-6">
                            <div class="col-md-12">

                                <ul class="pagination">


                                    <% include paginate.html %>




                                </ul>

                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12 super_admin_validate" style="padding: 0px;">
                           <select class="form-control select" data-none-selected-text="<%= __('title_nothing_selected') %>" id="selected_country_id" placeholder="Select Country" name="selected_country_id">
                            <option selected disabled hidden style='display: none'><%= __('title_select_country')%></option>
                            <option value="">All</option>
                            <% countries.forEach(function(country){ %>
                              <% if(selected_country_id == country._id.toString()){ %>
                                  <option value="<%= country._id %>" selected><%= country.countryname %></option>
                              <% } else { %>
                                  <option value="<%= country._id %>"><%= country.countryname %></option>
                              <% } %>
                            <% }) %>
                           </select>
                           </div>
                         </div>
    
                        <div  class="form-group col-md-4" >
                            <div class="col-md-6">
                                <button type="submit" id="apply_filter" class="btn btn-primary" style="height: 35px; width: 100%;  "><span><%= __('button_apply') %></span></button>
                            </div>
                            <div class="col-md-6">

                                <!-- <button class="btn btn-danger pull-right" type="button" style="height: 35px; width: 100%;" onClick ="$('#customers2').tableExport({type: 'excel', escape: 'false', ignoreColumn: [5, 7]});"><i class="fa fa-bars"></i> <%= __('button_export_excel') %></button> -->

                                <button class="btn btn-danger pull-right" type="button" style="height: 35px; width: 100%;" onClick ="export_excel()"><i class="fa fa-download"></i><%= __('button_export_excel') %></button>
                            </div>
                        </div>      
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">

            <div class="panel panel-default">

                <div class="table-responsive" style="padding-bottom: 175px;">
                    <table class="table" id="customers2">
                        <thead>
                            <tr>
                                <th><%= __('title_id') %></th>
                                <th><%= __('title_name') %></th>
                                <th>
                                    <%= __('title_total_request') %>
                                </th>
                                <th>
                                    <%= __('title_completed') %>
                                </th>
                                <th>
                                    <%= __('title_cancelled_request') %>
                                </th>
                                <th>
                                    <%= __('title_accepted_request') %>
                                </th>
                                <th><%= __('title_city') %></th>
                                <th><%= __('title_service_type') %></th>
                                <th>
                                    <%= __('title_status') %>
                                </th>
                                <th>
                                    <%= __('title_partner') %>
                                </th>
                                <th>
                                    <%= __('button_action') %>
                                </th>
                                <!-- <th><%= __('title_email') %>
                                </th>
                                <th>
                                    <%= __('title_phone') %>
                                </th>
                                <th><%= __('title_profile') %></th>
                                <th>
                                    <%= __('title_wallet') %>
                                </th>
                                <th><%= __('title_app_version') %></th>
                                <th>
                                    <%= __('title_registered_date') %>
                                </th>
                                <th>
                                    <%= __('title_created_from') %>
                                </th> -->
                            </tr>
                        </thead>

                        <tbody>




                            <% a = 0 %>


                            <% detail.forEach(function(data){ %>
                           
                            <tr class="demo">
                                <td>
                                    <%= data.unique_id %>
                                </td>
                                <td id="a">
                                    <%= data.first_name +' '+ data.last_name %>
                                </td>
                                <td>
                                    <%= data.total_request %>
                                </td>
                                <td>
                                    <%= data.completed_request %>
                                </td>
                                <td>
                                    <%= data.cancelled_request %>
                                </td>
                                <td>
                                    <%= data.accepted_request %>
                                </td>
                                <td>
                                    <%= data.city %>
                                </td>
                                <td>
                                    <%= data.service_type_name %>
                                </td>
                                <td>
                                    <%= data.is_approved == 1 ? __('button_approve') :  __('button_decline') %>
                                </td>
                                <td><% if(data.partner_ids.length > 0){ %>
                                    <button class="btn btn-link " onclick="show_partner_list('<%= data._id %>')">
                                        <%= __('title_partner') %>
                                    </button>
                                    <% }else{ %>
                                        -
                                    <% }%>
                                </td>
                              <td>
                                <div class="btn-group">
                                    <a href="#" data-toggle="dropdown" class="btn btn-primary dropdown-toggle">
                                        <%= __('button_action') %> <span class="caret"></span></a>
                                    <ul class="dropdown-menu" style="right: 0 !important; left: unset;" role="menu">
                                        <li>
                                            <form method="post" action="/profile_detail_edit">
                                                <input type="hidden" name="id" value="<%= data.id %>" />
                                                <input type="hidden" name="provider_page_type" value="<%= provider_page_type %>" />
                                                <button type="submit" class="btn btn-default" style="width:100%;"><%= __('title_edit_detail') %></button>
                                            </form>
                                        </li>
                                        <li>
                                            <form method="post" action="/provider_vehicle_list">
                                                <input type="hidden" name="provider_id" value="<%= data.id %>" />
                                                <input type="hidden" name="provider_page_type" value="<%= provider_page_type %>" />
                                                <button type="submit" class="btn btn-default" style="width:100%;"><%= __('title_vehicle') %></button>
                                            </form>
                                        </li>
                                        <!-- <li>
                                            <form method="post" action="/provider_bank_detail">
                                                <input type="hidden" name="id" value="<%= data.id %>" />
                                                <button type="submit" class="btn btn-default" style="width:100%;"><%= __('button_banking_detail') %> </button>
                                            </form>
                                        </li> -->
                                        <li>
                                            <form method="post" action="/history_pr">
                                                <input type="hidden" name="id" value="<%= data._id %>" />
                                                <button type="submit" class="btn btn-default" style="width:100%;"><%= __('button_history') %> </button>
                                            </form>
                                        </li>
                                        <li>
                                            <form method="post" action="/provider_referral_history">
                                                <input type="hidden" name="provider_id" value="<%= data._id %>" />

                                                <button type="submit" class="btn btn-default" style="width:100%;"><%= __('button_referral_history') %></button>
                                            </form>
                                        </li>
                                       
                                        <li>
                                            <form method="post" action="/proivder_documents">
                                                <input type="hidden" name="id" value="<%= data.id %>" />
                                                <button type="submit" class="btn btn-default" style="width:100%;"><%= __('button_view_documents') %> </button>
                                            </form>
                                        </li>
                                        
                                        <!-- <% if(data.is_approved == 1){ %>
                                            <li>
                                                <button type="button" onclick="add_wallet('<%= data._id %>')" class="btn btn-default" style="width:100%;"><%= __('button_add_wallet') %></button>
                                                
                                            </li>
                                        <% } %> -->
                                        
                                        <% if(data.is_approved == 1){ %>
                                        <li>
                                            <form method="post" action="profile_is_approved">
                                                <input type="hidden" name="id" value="<%= data.id %>">
                                                <input type="hidden" name="is_approved" value="<%= data.is_approved %>">
                                                <input type="hidden" name="is_document_uploaded" value="<%= data.is_document_uploaded %>">
                                                <input type="hidden" name="provider_page_type" value="<%= provider_page_type %>" />
                                                <input type="hidden" name="service_type" id="service<%= data.id %>" value="<%= data.service_type %>">
                                                <input type="submit" name="submit" class="btn btn-default" style="width: 100%" id='<%= data.id %>' value="<%= __('button_decline') %>">
                                            </form>
                                        </li>
                                        <% } else { %>
                                        <li>
                                            <form method="post" action="profile_is_approved">
                                                <input type="hidden" name="id" value="<%= data.id %>">
                                                <input type="hidden" name="is_approved" value="<%= data.is_approved %>">
                                                <input type="hidden" name="is_document_uploaded" value="<%= data.is_document_uploaded %>">
                                                <input type="hidden" name="city" id='city<%= data.id %>' value="<%= data.cityid %>">
                                                <input type="hidden" name="service_type" id='service<%= data.id %>' value="<%= data.service_type %>">
                                                <input type="hidden" name="provider_page_type" value="<%= provider_page_type %>" />
                                                <input type="submit" name="submit" id='sbt<%= data.id %>' value="<%= __('button_approve') %>">
                                            </form>
                                        </li>
                                        <% } %>
                                        <% if(data.is_trip.length > 0){ %>
                                            <li>
                                                <form method="post" action="unfreeze_provider">
                                                    <input type="hidden" name="id" value="<%= data.id %>" />
                                                    <input type="hidden" name="trip_id" value="<%= data.is_trip[0] %>" />
                                                    <input type="hidden" name="provider_page_type" value="<%= provider_page_type %>" />
                                                    <button type="submit" class="btn btn-default" style="width:100%;"><%= __('button_unfreeze') %> </button>
                                                </form>
                                            </li>
                                        <% } %>
                                    </ul>
                                </div>
                            </td>
                                <!-- <td>
                                    <% if(is_public_demo == true ) { %>
                                    <%= __('PUBLIC_DEMO_EMAIL') %>
                                    <% }else{ %>
                                    <%= data.email %> 
                                    <% } %>
                                </td>
                                <td>
                                    <%=  data.country_phone_code + data.phone %>
                                </td>


                                <td>
                                    <% if(data.is_active == 1 ) { %>
                                    <% if(data.is_available == 1 ) { %>
                                    <a href="<%= data.picture != '' ? setting_detail.image_base_url + data.picture : 'default.png' %>"><span class="btn btn-success btn-condensed"><i class="glyphicon glyphicon-user"></i></span></a>
                                    <% }else{ %>
                                    <a href="<%= data.picture != '' ? setting_detail.image_base_url + data.picture : 'default.png' %>"><span class="btn btn-info btn-condensed"><i class="glyphicon glyphicon-user"></i></span></a>
                                    <% } %>
                                    <% }else{ %>
                                    <a href="<%= data.picture != '' ? setting_detail.image_base_url + data.picture : 'default.png' %>"><span class="btn btn-danger btn-condensed"><i class="glyphicon glyphicon-user"></i></span></a>
                                    <% } %>
                                </td>
                                <td id="wallet<%= data._id %>">
                                    <%= data.wallet %>
                                </td>
                                <td>
                                    <%= data.device_type %>  -  <%= data.app_version %>
                                </td>
                                <td>
                                     <%= moment(data.created_at).tz(timezone_for_display_date).format("DD MMM 'YY") %></br><%= moment(data.created_at).tz(timezone_for_display_date).format("hh:mm a") %>
                                </td>
                                <td class="td_align">
                                    <% if(data.provider_type == 0 ) { %>
                                        <% if(data.device_type == 'web' ) { %>
                                            <%= __('title_web') %>
                                        <% }else{ %>
                                            <%= __('title_app') %>
                                        <% }%>
                                    <% }else if(data.provider_type == 1 ) { %>
                                      <%= __('title_partner_panel') %>
                                    <% }%>
                                  </td> -->


                                </div>

                            </tr>
                        <div class="modal animated fadeIn" id="service_type_select<%= data.id %>" tabindex="-1" role="dialog" aria-labelledby="smallModalHead"
                             aria-hidden="true">
                            <div class="modal-dialog" style="width: 300px;">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only"><%= __('button_close') %></span></button>
                                        <h4 class="modal-title"><%= __('title_select_service_type') %></h4>
                                    </div>
                                    <form class="form-horizontal" id="demo">
                                        <div class="modal-body">
                                            <div class="form-group">
                                                <div class="col-md-12">
                                                    <select class="form-control select" data-none-selected-text="<%= __('title_nothing_selected') %>" name="service_type_list" id="service_type_list<%= data.id %>">
                                                        <option selected disabled hidden style='display: none'></option>
                                                    </select>
                                                    <div id="message<%= data.id %>"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <input type="button" name="button" id="submit<%= data.id %>" value="submit">
                                        </div>
                                </div>
                                </form>
                            </div>
                        </div>

                        <% a++; }); %>
                        </tbody>
                    </table>

                </div>
                <!-- END SIMPLE DATATABLE -->
            </div>
        </div>
    </div>
    <% include colorbar.html %>

    <!-- PAGE CONTENT WRAPPER -->
</div>
<!-- END PAGE CONTENT -->
</div>
<!-- END PAGE CONTAINER -->

<div class="modal animated fadeIn" id="add_wallet_modal" tabindex="-1" role="dialog" aria-labelledby="smallModalHead" aria-hidden="true">
    <div class="modal-dialog" style="width: 300px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only"><%= __('button_close') %></span></button>
                <h4 class="modal-title"><%= __('title_add_wallet') %></h4>
            </div>
            <form class="form-horizontal" id="add_wallet_form">
                <div class="modal-body">
                    <div class="form-group">
                        <div class="col-md-12">
                            <input type="hidden" id="add_wallet_user_id" name="provider_id">
                            <input type="text" onkeypress="return isNumberKeyDecimal(event,this.value);"  name="wallet" id="wallet_amount" class="form-control" placeholder="<%= __('title_wallet_amount')%>">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="submit" class="btn btn-primary" name="button" value="<%= __('button_add')%>">
                </div>
        </div>
        </form>
    </div>
</div>
<div class="modal fade" id="show_partner_modal" tabindex="-1" role="dialog" aria-labelledby="smallModalHead" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" >
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only"><%= __('button_close') %></span></button>
                <h4 class="modal-title" style="color: rgb(37 14 98); text-align: center;"><%= __('title_partners') %></h4>
            </div>
              <div class="modal-body" style="text-align: center;">
                  <div class="partners">
                    
                  </div>
                </div>
        </div>
    </div>
  </div>


<script type="text/javascript" src="js/dist/pdfmake.min.js"></script>
<script type="text/javascript" src="js/dist/vfs_fonts.js"></script>
<script type="text/javascript">
                            //$(document).ready(function(){

                            /*$('#demo').click(function(e){
                               
                             $('#header').show();
                             var docDefinition = {
                             content: [{
                             style: 'tableExample',
                             table: {
                               
                             body: [
                             [ 'PROVIDER NAME', 'EMAIL', 'PHONE', 'ADDRESS' , 'ZIPCODE'],
                             <% detail.forEach(function(data){ %>
                             [ '<%= data.first_name %>  <%= data.last_name %>', '<%= data.email %>', '<%= data.country_phone_code %>  <%= data.phone %>', '<%= data.address %>','<%= data.zipcode %>'],
                             <% }); %>
                             ]
                             }
                             }]
                             };
                               
                             pdfMake.createPdf(docDefinition).download(Math.random()+".pdf");
                             $('#header').hide();
                               
                             });
                             });*/

</script>

<script type="text/javascript">
    $(document).ready(function() {


    $('#<%= sort_field %>s').prop("selected",true);

    $('#start_date').datepicker({
         format: 'yyyy-mm-dd',
        <% if(filter_end_date){ %>
          endDate: new Date("<%= filter_end_date %>")
        <% }else{ %>
        endDate: new Date(Date.now())
        <% } %>

    }).on("input change", function (e) {
    var end_date = $('#start_date').datepicker('getDate');
            end_date.setDate(end_date.getDate() + 1);
            $('#end_date').datepicker('setStartDate', end_date);
            $('.datepicker-dropdown').hide()
    });
    
            $('#end_date').datepicker({
            format: 'yyyy-mm-dd',
            endDate: new Date(Date.now()),
            <% if(filter_start_date){ %>
              startDate: new Date("<%= filter_start_date %>")
            <% } %>

    }).on("input change", function (e) {
    var start_date = $('#end_date').datepicker('getDate');
            start_date.setDate(start_date.getDate() - 1);
            $('#start_date').datepicker('setEndDate', start_date);
            $('.datepicker-dropdown').hide()
    });
    
    $('#add_wallet_form').validate({
            rules: {
                wallet : "required"
            },
            submitHandler: function (form) {

                var provider_id = $('#add_wallet_user_id').val();
                $.ajax({
                    type: 'POST',
                    url: '/admin_add_provider_wallet',
                    data: $("#add_wallet_form").serialize(),
                    dataType: "json",
                    success: function (res) {
                        
                        $('#add_wallet_modal').modal('hide');
                        $('#wallet_amount').val('');
                        if(res.success == true)
                        {
                            $('#wallet'+provider_id).html(res.wallet); 
                            $('#promo_error').show();
                            setTimeout(function () {
                                $('#promo_error').hide();
                            }, 3000);
                            document.getElementById('message').innerHTML = "<%= __('success_message_add_wallet') %>";
                        }
                        else
                        {
                            $('#promo_error').show();
                            setTimeout(function () {
                                $('#promo_error').hide();
                            }, 3000);
                            document.getElementById('message').innerHTML = res.error_code;
                        }
                    }
                });
            }
        })
    
    });

    function show_partner_list(id) {
        $.ajax({
        type: 'POST', // define the type of HTTP verb we want to use (POST for our form)
        url: '/admin_get_provider_partners', /// the url where we want to POST
        data: {
            provider_id: id
        }, // our data object
        datatype: "json",
        success: function(response) {
            $('.partners').empty()
            response.partners.forEach((element, index) => {
                $('.partners').append(
                    '<h5 class="card-title">Partner '+(index + 1)+'</h5></div></div></div>' +
                    '<p><span class="static-text"><%= __('title_name') %>:</span>' +
                    '<span class="dynamic-text"> '+element.first_name +' '+ element.last_name +' </span></p>' +
                    '<p><span class="static-text"><%= __('title_phone') %>: </span>' +
                    '<span class="dynamic-text">'+element.country_phone_code +' '+ element.phone +' </span></p>'
                )
            })
            $("#show_partner_modal").modal('show');
        }
        });
    }

    function add_wallet(id)
    {
        $('#add_wallet_user_id').val(id);
        $('#add_wallet_modal').modal('show');
    }

    function isNumberKey(evt){
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57)){
            if( charCode == 46 || charCode == 45)
            {
                    return true;
            }
            else
            {
                    return false;
            }
        }
        return true;
    }

    function export_excel(){

        $.ajax({
                  type: 'POST',
                  url: '/generate_provider_excel',
                  data: $('.form-horizontal').serialize(),
                  dataType: "json",
                  success: function (res) {
                      window.open(res)
                  }
        });
      }

</script>

</div>

<% include footer_list.html %>